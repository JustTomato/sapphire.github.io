"use strict";(self.webpackChunksapphire=self.webpackChunksapphire||[]).push([[665],{3905:(e,n,t)=>{t.d(n,{Zo:()=>i,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},i=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),u=c(t),h=a,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||s;return t?r.createElement(m,p(p({ref:n},i),{},{components:t})):r.createElement(m,p({ref:n},i))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,p=new Array(s);p[0]=h;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[u]="string"==typeof e?e:a,p[1]=o;for(var c=2;c<s;c++)p[c]=t[c];return r.createElement.apply(null,p)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},3539:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>p,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var r=t(7462),a=(t(7294),t(3905));const s={},p="Express",o={unversionedId:"node/Express",id:"node/Express",title:"Express",description:"1.\u4e0eKoa\u5bf9\u6bd4",source:"@site/docs/node/Express.md",sourceDirName:"node",slug:"/node/Express",permalink:"/sapphire.github.io/docs/node/Express",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Koa",permalink:"/sapphire.github.io/docs/node/Koa"},next:{title:"\u8fdb\u9636Vue\u7bc7\uff08\u4e00\uff09",permalink:"/sapphire.github.io/docs/vue/Basic"}},l={},c=[{value:"1.\u4e0eKoa\u5bf9\u6bd4",id:"1\u4e0ekoa\u5bf9\u6bd4",level:3},{value:"2.\u7b80\u5355\u5730\u4f7f\u7528express",id:"2\u7b80\u5355\u5730\u4f7f\u7528express",level:3},{value:"3.\u67e5\u770bexpress\u6a21\u5757\u7684\u7ed3\u6784\uff0c\u7528\u4e8e\u624b\u52a8\u5b9e\u73b0express",id:"3\u67e5\u770bexpress\u6a21\u5757\u7684\u7ed3\u6784\u7528\u4e8e\u624b\u52a8\u5b9e\u73b0express",level:3},{value:"4.\u624b\u52a8\u5b9e\u73b0express",id:"4\u624b\u52a8\u5b9e\u73b0express",level:3}],i={toc:c},u="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},i,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"express"},"Express"),(0,a.kt)("h3",{id:"1\u4e0ekoa\u5bf9\u6bd4"},"1.\u4e0eKoa\u5bf9\u6bd4"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"koa\u548cexpress\u7684\u533a\u522b"),(0,a.kt)("p",{parentName:"blockquote"},"1.express\u5185\u90e8\u662f\u901a\u8fc7\u56de\u8c03\u51fd\u6570\u7684\u6765\u5b9e\u73b0\u7684\u3002koa\u5219\u91c7\u7528async/await\u7684ES6\u8bed\u6cd5\uff0c\u5185\u90e8\u91c7\u7528\u7684promise"),(0,a.kt)("p",{parentName:"blockquote"},"2.\u4e24\u8005\u90fd\u662f\u57fa\u4e8ehttp\u6a21\u5757\u5c01\u88c5\u7684\uff0c"),(0,a.kt)("p",{parentName:"blockquote"},"3.koa\u5185\u90e8\u6bd4\u8f83\u5c0f\u5de7\uff0c\u5185\u90e8\u5b9e\u73b0\u4e86\u4e3b\u8981use\u8ddflisten\u65b9\u6cd5\uff1b\u5728\u4f7f\u7528\u65f6\u5219\u9700\u8981\u642d\u914d\u5176\u4ed6\u7684\u63d2\u4ef6\u6765\u4f7f\u7528\u50cfkoa-static\u3001koa-view\u3001koa-router"),(0,a.kt)("p",{parentName:"blockquote"},"4.\u800cexpress\u5185\u90e8\u5219\u5305\u542b\u4e86\u5f88\u591a\u4e2d\u95f4\u4ef6\uff0c\u5728\u4f7f\u7528\u4e2d\u76f8\u5bf9\u800c\u8a00express\u4f1a\u6bd4koa\u4f7f\u7528\u7684\u591a\u4e00\u4e9b"),(0,a.kt)("p",{parentName:"blockquote"},"5.\u4e24\u8005\u90fd\u53ef\u4ee5\u901a\u8fc7\u81ea\u5df1\u7684\u89c4\u5219\u6765\u5b9e\u73b0mvc\u529f\u80fd"),(0,a.kt)("p",{parentName:"blockquote"},"6.koa\u5e95\u5c42\u4f7f\u7528\u4e86\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff0c\u5c01\u88c5\u4e86ctx\uff0c\u800cexpress\u5219\u6ca1\u6709\uff0c\u5185\u90e8\u4f7f\u7528\u4e86\u539f\u751f\u7684res\u3001req\u8fdb\u884c\u4e86\u5c01\u88c5"),(0,a.kt)("p",{parentName:"blockquote"},"7.koa\u548cexpress\u90fd\u6709\u4e2d\u95f4\u4ef6\u7684\u6982\u5ff5\uff0c\u4f46\u662fexpress\u5185\u90e8\u4e0d\u652f\u6301promise")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.expressjs.com.cn/4x/api.html"},"Express\u57fa\u4e8eNode.js\u5e73\u53f0\uff0c\u5feb\u901f\u3001\u5f00\u653e\u3001\u6781\u7b80\u7684 Web \u5f00\u53d1\u6846\u67b6")),(0,a.kt)("h3",{id:"2\u7b80\u5355\u5730\u4f7f\u7528express"},"2.\u7b80\u5355\u5730\u4f7f\u7528express"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const express = require('express'); //const koa = require('koa)\n\nconst app = express(); //cosnt app = new Koa();\n//\u7531\u4e8eexpress\u5b9e\u73b0\u7684\u6bd4\u8f83\u65e9\uff0c\u4f46\u662f\u6ca1\u6709class\u7c7b\u7684\u6982\u5ff5\u800c\u662f\u91c7\u7528\u4e86\u6784\u9020\u51fd\u6570\u7684\u5199\u6cd5\uff0c\u662f\u51fd\u6570\u6267\u884c\u7684\u5199\u6cd5\n\n\n\n//koa-router \u4e5f\u662f\u501f\u9274\u4e86express\u4e2d\u81ea\u5e26\u7684\u8def\u7531\u7f16\u5199\u7684\napp.get('/', function (req, res) {\n    //\u53c2\u6570\u4e2d\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u53c2\u6570\u53ea\u6709\u539f\u751f\u7684req\\res\u3002\u6ca1\u6709\u50cfkoa\u5c01\u88c5\u4e86ctx\n    res.end('home')\n}) //app.use();\n\napp.get('/about', function (req, res) {\n    res.end('about')\n})\n\napp.listen(3000)\n")),(0,a.kt)("h3",{id:"3\u67e5\u770bexpress\u6a21\u5757\u7684\u7ed3\u6784\u7528\u4e8e\u624b\u52a8\u5b9e\u73b0express"},"3.\u67e5\u770bexpress\u6a21\u5757\u7684\u7ed3\u6784\uff0c\u7528\u4e8e\u624b\u52a8\u5b9e\u73b0express"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tex"},"express\n\u251c\u2500 index.js\n\u251c\u2500 lib\n\u2502    \u251c\u2500 application.js\n\u2502    \u251c\u2500 express.js\n\u2502    \u251c\u2500 middleware\n\u2502    \u2502    \u251c\u2500 init.js\n\u2502    \u2502    \u2514\u2500 query.js\n\u2502    \u251c\u2500 request.js\n\u2502    \u251c\u2500 response.js\n\u2502    \u251c\u2500 router\n\u2502    \u2502    \u251c\u2500 index.js\n\u2502    \u2502    \u251c\u2500 layer.js\n\u2502    \u2502    \u2514\u2500 route.js\n\u2502    \u251c\u2500 utils.js\n\u2502    \u2514\u2500 view.js\n")),(0,a.kt)("h3",{id:"4\u624b\u52a8\u5b9e\u73b0express"},"4.\u624b\u52a8\u5b9e\u73b0express"),(0,a.kt)("p",null,"\u6d4b\u8bd5\u6587\u4ef61.server.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const express = require('./express'); //const koa = require('koa)\nconst app = express(); //cosnt app = new Koa();\n//\u7531\u4e8eexpress\u5b9e\u73b0\u7684\u6bd4\u8f83\u65e9\uff0c\u4f46\u662f\u6ca1\u6709class\u7c7b\u7684\u6982\u5ff5\u800c\u662f\u91c7\u7528\u4e86\u6784\u9020\u51fd\u6570\u7684\u5199\u6cd5\uff0c\u662f\u51fd\u6570\u6267\u884c\u7684\u5199\u6cd5\n//koa-router \u4e5f\u662f\u501f\u9274\u4e86express\u4e2d\u81ea\u5e26\u7684\u8def\u7531\u7f16\u5199\u7684\napp.get('/', function (req, res) {\n    //\u53c2\u6570\u4e2d\u7684\u56de\u8c03\u51fd\u6570\u4e2d\u53c2\u6570\u53ea\u6709\u539f\u751f\u7684req\\res\u3002\u6ca1\u6709\u50cfkoa\u5c01\u88c5\u4e86ctx\n    res.end('home')\n}) //app.use();\n\napp.get('/about', function (req, res) {\n    res.end('about')\n})\napp.all('*',function(req,res){\n    res.end('all')\n})\napp.listen(3000,function(){\n    console.log('server start')\n})\n")),(0,a.kt)("p",null,"express/index.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"let express = require('./lib/express');\nmodule.exports = express\n")),(0,a.kt)("p",null,"express/lib/express.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const http = require('http');\nconst url = require('url');\nconst routes = [\n    {\n        path: '*',\n        method: 'all',\n        handler: (req, res) => { res.end(`Cannot ${req.method} ${req.url}`) }\n    }\n]\n\nfunction createApplication() {\n    return {\n        all(path, callback) {\n            routes.push({\n                path,\n                method: 'all',\n                handler: callback\n            })\n        },\n        get(path, callback) {\n            routes.push({\n                path,\n                method: 'get',\n                handler: callback\n            })\n        },\n        listen(...args) {\n            // Array.prototype.slice.call(arguments);\n            const server = http.createServer((req, res) => {\n                let { pathname } = url.parse(req.url);\n                let requestMethod = req.method.toLowerCase();\n                for (let i = 1; i < routes.length; i++) {\n                    let { path, method, handler } = routes[i]\n                    if ((pathname == path || path === '*') && (method === requestMethod || method === 'all')) {\n                        return handler(req, res)\n                    }\n                }\n                routes[0].handler(req, res)\n\n            })\n            server.listen(...args)\n        }\n    }\n}\n\nmodule.exports = createApplication\n")),(0,a.kt)("p",null,"\u62c6\u5206express.js"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"1.createApplication "),(0,a.kt)("p",{parentName:"blockquote"},"2.application"),(0,a.kt)("p",{parentName:"blockquote"},"3.router")),(0,a.kt)("p",null,"1.\u5728lib\u4e2d\u65b0\u5efaapplication.js\uff0c\u62c6\u5206\u5e94\u7528\u5c42"),(0,a.kt)("p",null,"application.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const http = require('http');\nconst url = require('url');\nconst routes = [\n    {\n        path: '*',\n        method: 'all',\n        handler: (req, res) => { res.end(`Cannot ${req.method} ${req.url}`) }\n    }\n]\nfunction Application() {\n\n}\nApplication.prototype.get = function (path, callback) {\n    routes.push({\n        path,\n        method: 'get',\n        handler: callback\n    })\n};\n// Application.prototype.all = function (path, callback) {\n//     routes.push({\n//         path,\n//         method: 'all',\n//         handler: callback\n//     })\n// };\nApplication.prototype.listen = function (...args) {\n    // Array.prototype.slice.call(arguments);\n    const server = http.createServer((req, res) => {\n        let { pathname } = url.parse(req.url);\n        let requestMethod = req.method.toLowerCase();\n        for (let i = 1; i < routes.length; i++) {\n            let { path, method, handler } = routes[i]\n            // if ((pathname == path || path === '*') && (method === requestMethod || method === 'all')) {\n            if (pathname == path && method === requestMethod) {\n                return handler(req, res)\n            }\n        }\n        routes[0].handler(req, res)\n\n    })\n    server.listen(...args)\n}\n\nmodule.exports = Application\n")),(0,a.kt)("p",null,"express.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const Application = require('./application.js');\nfunction createApplication() {\n    return new Application()\n}\nmodule.exports = createApplication\n")),(0,a.kt)("p",null,"2.\u5e94\u7528\u7cfb\u7edf\u8ddf\u8def\u7531\u7cfb\u7edf\u7684\u62c6\u5206\uff0c\u65b0\u5efarouter\u6587\u4ef6\u5939\uff08\u56e0\u4e3a\u8def\u7531\u6587\u4ef6\u6bd4\u8f83\u591a\uff09\uff0c\u65b0\u5efaindex.js"))}d.isMDXComponent=!0}}]);